{% extends "core/base.jinja" %}

{% block title %}
{% trans %}SAS{% endtrans %}
{% endblock %}

{% macro print_path(file) %}
{% if file and file.parent %}
{{ print_path(file.parent) }}
<a href="{{ url('sas:album', album_id=file.id) }}">{{ file.get_display_name() }}</a> >
{% endif %}
{% endmacro %}


{% block content %}
<a href="{{ url('sas:main') }}">SAS</a> > {{ print_path(album.parent) }} {{ album.get_display_name() }}
<h3>{{ album.get_display_name() }}</h3>
<hr>
<div>
    {% for a in album.children.filter(is_folder=True, is_moderated=True).all() %}
    <a href="{{ url("sas:album", album_id=a.id) }}" style="display: inline-block">
    <div class="album">
        <div>
        {% if a.children.filter(is_folder=False, is_moderated=True).exists() %}
        <img src="{{ a.children.filter(is_folder=False).first().as_picture.get_download_thumb_url() }}" alt="{% trans %}preview{% endtrans %}">
        {% else %}
        <img src="{{ static('core/img/sas.jpg') }}" alt="{% trans %}preview{% endtrans %}">
        {% endif %}
        </div>
        {{ a.name }}
    </div>
    </a>
    {% endfor %}
</div>
<div>
    {% for p in album.children.filter(is_folder=False, is_moderated=True).all() %}
    {% if p.as_picture.can_be_viewed_by(user) %}
    <div class="picture">
        <a href="{{ url("sas:picture", picture_id=p.id) }}#pict">
            <img src="{{ p.as_picture.get_download_thumb_url() }}" alt="{{ p.get_display_name() }}" />
        </a>
    </div>
    {% endif %}
    {% endfor %}
</div>
<form action="" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p() }}
    <p><input type="submit" value="{% trans %}Upload{% endtrans %}" /></p>
</form>
{% endblock %}

