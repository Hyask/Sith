{% extends "core/base.jinja" %}

{% block title %}
{% trans %}Election list{% endtrans %}
{% endblock %}

{% block content %}
	{% if object.has_voted(request.user) %}
		A vot√©
	{% endif %}
	<h1>{{object.title}}</h1>
	<p>{{object.description}}</p>
	<p>{% trans %}End :{% endtrans %} {{object.end_date}}</p>
	{% if object.election_list.exists() %}
	<table>
		<tr>
		{% set nb_list = object.election_list.all().count() + 1 -%}
		{% for liste in object.election_list.all() %}
			<td>{{liste.title}}</td>
			{% if object.is_candidature_active -%}
			{% set nb_list = nb_list -%}
			{% else -%}
			{% set nb_list = nb_list + 1 -%}
			{% endif -%}
		{% endfor %}
		{% if not object.is_candidature_active -%}
		<td>{% trans %}Blank vote{% endtrans %}</td>
		{% endif %}
		</tr>
	{% for role in object.role.all() %}
		<tr><td colspan={{nb_list}}>{{role.title}}</td></tr>
		<tr>
			{% for liste in object.election_list.all() %}
			<td>
				<ul>
				{% for candidature in role.candidature.filter(election_list=liste) %}
				<li>
					{{candidature.user.first_name}} {{candidature.user.last_name}} {{candidature.user.nick_name or ''}}
					{% if candidature.user.profile_pict %}
					<br>
						<img src="{{candidature.user.profile_pict.get_download_url()}}" alt="{% trans %}Profile{% endtrans %}">
					{% endif %}
					<br>
					{{candidature.program or ''}}
				</li>
				{% endfor %}
				</ul>
			</td>
			{% endfor %}
			{% if not object.is_candidature_active -%}
			<td></td>
			{% endif %}
		</tr>
	{% endfor %}
	</table>
	{% endif %}
	<form>{{candidate_form}}</form>
	{% if object.is_candidature_active -%}
		candidature
	{% endif -%}
{% endblock %}